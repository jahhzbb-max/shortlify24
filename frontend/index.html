<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shortlify</title>
<style>
body {
  margin: 0;
  font-family: Poppins, sans-serif;
  background: #0d0f1a;
  color: white;
  text-align: center;
  padding: 50px;
}
input {
  width: 80%;
  max-width: 500px;
  padding: 15px;
  border-radius: 12px;
  border: none;
  font-size: 16px;
}
button {
  margin-top: 20px;
  padding: 14px 25px;
  background: #6c7bff;
  border: none;
  border-radius: 12px;
  color: white;
  font-size: 16px;
  cursor: pointer;
}
#shortLink a {
  color: #6c7bff;
  text-decoration: none;
  word-break: break-all;
}
</style>
</head>
<body>

<h1>Shortlify URL Shortener</h1>

<input type="text" id="longUrl" placeholder="Enter your URL..." />
<button id="shortBtn">Shorten</button>

<p id="shortLink"></p>

<script>
// BACKEND URL টি মুছে ফেলা হয়েছে, কারণ আমরা এখন Vercel API ব্যবহার করব
// const BACKEND = "https://shortlify24.onrender.com"; 

document.getElementById("shortBtn").onclick = async () => {
    const url = document.getElementById("longUrl").value.trim();
    if (!url) return alert("Enter a URL first!");

    try {
        // fetch URL পরিবর্তন করে Vercel-এর জন্য রিলেটিভ পাথ করা হয়েছে
        const res = await fetch(`/api/shorten`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ url })
        });

        const data = await res.json();
        console.log(data);

        if (data.id) {
            // URL পরিবর্তন করে সরাসরি ডোমেইনের পরে শর্ট আইডি ব্যবহার করার জন্য
            const shortUrl = `${window.location.origin}/${data.id}`;
            document.getElementById("shortLink").innerHTML = `
                Short URL: <a href="${shortUrl}" target="_blank">${shortUrl}</a>
            `;
        } else {
            alert("Error shortening URL");
        }
    } catch (err) {
        console.error(err);
        alert("Server error!");
    }
};
</script>

</body>
</html>
